const c=["/api/google-reviews","/.netlify/functions/google-reviews"];function u(t="Google User"){const o=t.trim().split(/\s+/).filter(Boolean);return o.length===0?"GU":o.length===1?o[0].slice(0,2).toUpperCase():`${o[0][0]??""}${o[1][0]??""}`.toUpperCase()}function g(t){const o=(t==null?void 0:t.author_name)??"Google User";return{name:o,role:t!=null&&t.relative_time_description?`Google Review â€¢ ${t.relative_time_description}`:"Google Review",company:"Google",initials:u(o),rating:Number.isFinite(t==null?void 0:t.rating)?t.rating:5,text:(t==null?void 0:t.text)??"",avatarUrl:(t==null?void 0:t.profile_photo_url)??""}}async function p({limit:t=6,signal:o}={}){const s=[];for(const e of c)try{const a=`${e}?limit=${encodeURIComponent(t)}`,i=await fetch(a,{method:"GET",signal:o});if(!i.ok){s.push(`${e}: ${i.status}`);continue}const n=await i.json();if(!Array.isArray(n==null?void 0:n.reviews)||n.reviews.length===0){s.push(`${e}: no reviews`);continue}const r=n.reviews.map(g).filter(l=>l.text.trim().length>0);if(r.length===0){s.push(`${e}: empty mapped reviews`);continue}return{source:n.source??"google-places",rating:n.rating??null,userRatingsTotal:n.user_ratings_total??null,fetchedAt:n.fetched_at??null,testimonials:r}}catch(a){s.push(`${e}: ${a instanceof Error?a.message:"unknown error"}`)}throw new Error(`No dynamic review endpoint available. ${s.join(" | ")}`)}export{p as f};
